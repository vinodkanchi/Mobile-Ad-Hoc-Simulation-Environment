function [sym1_rx,sym2_rx,sym3_rx,sym4_rx,sym5_rx,sym6_rx,sym7_rx,sym8_rx] = f_SIM_OSTBC_decode(...
    d1,d2,d3,d4,d5,d6,d7,d8,d9,d10,d11,d12,d13,d14,d15,d16,...
    H1_ray,H2_ray,H3_ray,H4_ray,H5_ray,H6_ray,H7_ray,H8_ray,h1,h2,h3,h4,h5,h6,h7,h8)

%%
% CHANNEL MATRIX
% H = [   h1       h2      h3      h4
%         h2      -h1      h4     -h3
%         h3      -h4     -h1      h2
%         h4       h3     -h2     -h1
%         h1*      h2*     h3*     h4*
%         h2*     -h1*     h4*    -h3*
%         h3*     -h4*    -h1*     h2*
%         h4*      h3*    -h2*    -h1*    ]

% H^H = [     h1*    h2*     h3*     h4*    h1     h2     h3     h4
%             h2*   -h1*    -h4*     h3*    h2    -h1    -h4    -h3
%             h3*    h4*    -h1*    -h2*    h3     h4    -h1    -h2
%             h4*   -h3*     h2*    -h1*    h4    -h3     h2    -h1     ]



%% Perform Decoding
% SYMBOL 1
sym1_rx = ...
      conj(h1.*H1_ray).*d1 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(h2.*H2_ray).*d2 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(h3.*H3_ray).*d3 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(h4.*H4_ray).*d4 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(h5.*H5_ray).*d5 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(h6.*H6_ray).*d6 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(h7.*H7_ray).*d7 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(h8.*H8_ray).*d8 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (h1.*H1_ray).*conj(d9)  ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (h2.*H2_ray).*conj(d10) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (h3.*H3_ray).*conj(d11) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (h4.*H4_ray).*conj(d12) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (h5.*H5_ray).*conj(d13) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (h6.*H6_ray).*conj(d14) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)... 
    + (h7.*H7_ray).*conj(d15) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (h8.*H8_ray).*conj(d16) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2);


% SYMBOL 2

sym2_rx = ...
      conj(h2.*H2_ray).*d1 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(-h1.*H1_ray).*d2 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(h4.*H4_ray).*d3 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(-h3.*H3_ray).*d4 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(h6.*H6_ray).*d5 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(-h5.*H5_ray).*d6 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(-h8.*H8_ray).*d7 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(h7.*H7_ray).*d8 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (h2.*H2_ray).*conj(d9)  ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (-h1.*H1_ray).*conj(d10) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (h4.*H4_ray).*conj(d11) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (-h3.*H3_ray).*conj(d12) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (h6.*H6_ray).*conj(d13) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (-h5.*H5_ray).*conj(d14) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)... 
    + (-h8.*H8_ray).*conj(d15) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (h7.*H7_ray).*conj(d16) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2);

% SYMBOL 3

sym3_rx = ...
      conj(h3.*H3_ray).*d1 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(-h4.*H4_ray).*d2 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(-h1.*H1_ray).*d3 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(h2.*H2_ray).*d4 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(h7.*H7_ray).*d5 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(h8.*H8_ray).*d6 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(-h5.*H5_ray).*d7 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(-h6.*H6_ray).*d8 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (h3.*H3_ray).*conj(d9)  ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (-h4.*H4_ray).*conj(d10) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (-h1.*H1_ray).*conj(d11) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (h2.*H2_ray).*conj(d12) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (h7.*H7_ray).*conj(d13) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (h8.*H8_ray).*conj(d14) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)... 
    + (-h5.*H5_ray).*conj(d15) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (-h6.*H6_ray).*conj(d16) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2);


% SYMBOL 4
sym4_rx = ...
      conj(h4.*H4_ray).*d1 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(h3.*H3_ray).*d2 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(-h2.*H2_ray).*d3 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(-h1.*H1_ray).*d4 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(h8.*H8_ray).*d5 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(-h7.*H7_ray).*d6 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(h6.*H6_ray).*d7 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(-h5.*H5_ray).*d8 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (h4.*H4_ray).*conj(d9)  ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (h3.*H3_ray).*conj(d10) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (-h2.*H2_ray).*conj(d11) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (-h1.*H1_ray).*conj(d12) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (h8.*H8_ray).*conj(d13) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (-h7.*H7_ray).*conj(d14) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)... 
    + (h6.*H6_ray).*conj(d15) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (-h5.*H5_ray).*conj(d16) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2);



% SYMBOL 5
sym5_rx = ...
      conj(h5.*H5_ray).*d1 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(-h6.*H6_ray).*d2 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(-h7.*H7_ray).*d3 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(-h8.*H8_ray).*d4 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(-h1.*H1_ray).*d5 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(h2.*H2_ray).*d6 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(h3.*H3_ray).*d7 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(h4.*H4_ray).*d8 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (h5.*H5_ray).*conj(d9)  ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (-h6.*H6_ray).*conj(d10) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (-h7.*H7_ray).*conj(d11) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (-h8.*H8_ray).*conj(d12) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (-h1.*H1_ray).*conj(d13) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (h2.*H2_ray).*conj(d14) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)... 
    + (h3.*H3_ray).*conj(d15) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (h4.*H4_ray).*conj(d16) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2);


% SYMBOL 6
sym6_rx = ...
      conj(h6.*H6_ray).*d1 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(h5.*H5_ray).*d2 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(-h8.*H8_ray).*d3 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(h7.*H7_ray).*d4 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(-h2.*H2_ray).*d5 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(-h1.*H1_ray).*d6 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(-h4.*H4_ray).*d7 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(h3.*H3_ray).*d8 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (h6.*H6_ray).*conj(d9)  ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (h5.*H5_ray).*conj(d10) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (-h8.*H8_ray).*conj(d11) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (h7.*H7_ray).*conj(d12) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (-h2.*H2_ray).*conj(d13) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (-h1.*H1_ray).*conj(d14) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)... 
    + (-h4.*H4_ray).*conj(d15) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (h3.*H3_ray).*conj(d16) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2);


% SYMBOL 7
sym7_rx = ...
      conj(h7.*H7_ray).*d1 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(h8.*H8_ray).*d2 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(h5.*H5_ray).*d3 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(-h6.*H6_ray).*d4 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(-h3.*H3_ray).*d5 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(h4.*H4_ray).*d6 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(-h1.*H1_ray).*d7 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(-h2.*H2_ray).*d8 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (h7.*H7_ray).*conj(d9)  ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (h8.*H8_ray).*conj(d10) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (h5.*H5_ray).*conj(d11) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (-h6.*H6_ray).*conj(d12) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (-h3.*H3_ray).*conj(d13) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (h4.*H4_ray).*conj(d14) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)... 
    + (-h1.*H1_ray).*conj(d15) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (-h2.*H2_ray).*conj(d16) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2);


% SYMBOL 8
sym8_rx = ...
      conj(h8.*H8_ray).*d1 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(-h7.*H7_ray).*d2 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(h6.*H6_ray).*d3 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(h5.*H5_ray).*d4 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(-h4.*H4_ray).*d5 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(-h3.*H3_ray).*d6 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(h2.*H2_ray).*d7 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + conj(-h1.*H1_ray).*d8 ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (h8.*H8_ray).*conj(d9)  ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (-h7.*H7_ray).*conj(d10) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (h6.*H6_ray).*conj(d11) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (h5.*H5_ray).*conj(d12) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (-h4.*H4_ray).*conj(d13) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (-h3.*H3_ray).*conj(d14) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)... 
    + (h2.*H2_ray).*conj(d15) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2)...
    + (-h1.*H1_ray).*conj(d16) ./(abs(H1_ray).^2+abs(H2_ray).^2+abs(H3_ray).^2+abs(H4_ray).^2+abs(H5_ray).^2+abs(H6_ray).^2+abs(H7_ray).^2+abs(H8_ray).^2);


